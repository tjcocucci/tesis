\chapter{Conclusiones}

En este trabajo damos un marco teórico general para asimilación de datos y presentamos las metodologías más populares, con especial énfasis en métodos basados en ensambles como el EnKF y el filtro de partículas. Luego, presentamos el problema de la especificación de errores en este tipo sistemas, mostrando como afectan en la performance y comentando estrategias útiles para tratar con estas incertezas. Uno de los objetivos de mi doctorado es el de desarrollar técnicas de estimación de estos errores con interés particular en metodologías secuenciales y basadas en el algoritmo EM. A modo de avance en esta dirección desarrollamos lo que constituye una de las contribuciones principales del trabajo que integra esta tesis: una metodología \textit{online} de estimación del error de modelo y observacional basada en el EM junto con una evaluación experimental de su desempeño en escenarios de interés para el área. Tiene la propiedad de acoplarse a técnicas de asimilación de datos por ensamble modernas como el EnKF o el VMPF. Otro de los objetivos de la tesis es la utilización de metodologías de este tipo sobre modelos epidemiológicos. Por lo tanto también realizamos experimentos de aplicación del EM \textit{online} para un modelo compartimental simple de COVID-19 utilizando tanto datos sintéticos como reales. Previo a esto presentamos los modelos epidemiológicos compartimentales clásicos así como los antecedentes de inferencia sobre estos, haciendo énfasis en los trabajos que utilizan técnicas de asimilación de datos. El creciente interés en modelos basados en agentes nos motivó a extender parte de nuestro trabajo de investigación a este tipo de modelado. Otra de las contribuciones más relevantes de este trabajo es la de un marco genreal de aplicación de técnicas de asimilación de datos por ensambles en modelos basados en agentes. Tomamos como ejemplo de aplicación un modelo para COVID-19 y evaluamos experimentalmente la metodología.

El algoritmo EM \textit{online} que desarrollamos mostró resultados satisfactorios en los escenarios en los que fue evaluado. La versión que se acopla al EnKF con un paso de suavizado de EnKS tiene una menor complejidad computacional que el EM \textit{offline} acoplado al EnKS (\cite{Pulido2018}). Además tiene la propiedad de que puede capturar cambios temporales lentos en los parámetros e incluso recuperar la estructura de covarianzas de las matrices que parametrizan los errores. La performance del método sin embargo depende de la elección de la tasa de aprendizaje. Esta cuantifica cuanta importancia se le da a la observación que está siendo procesada en comparación a la estimación previa. El problema es similar a los de la elección de una tasa de aprendizaje para métodos de descenso de gradiente en machine learning. Por lo tanto, una posible línea de investigación es buscar incluir en el EM \textit{online} una tasa de aprendizaje adaptativa del tipo momentum, ADAGRAD o ADADELTA \citep{Zeiler2012} o ADAM \citep{Kingma2014}. Estos métodos se adaptan de manera dinámica a la tarea de optimización y pueden mejorar dramáticamente la convergencia. Creemos que la maximización de la verosimilitud mediante EM puede ser reinterpretada como un método de gradientes lo que permitiría utilizar la vasta caja de herramientas provista en gran parte por el desarrollo moderno de métodos de machine learning. En particular es muy posible que este enfoque permita una reinterpretación similar para los métodos \textit{online}.

Otro desafío pendiente para nuestro algoritmo es el de su desempeño en sistemas de alta dimensionalidad. El problema de la asimilación de datos en alta dimensionalidad atrae gran interés debido a que muchos modelos geofísicos consideran grillas espaciales que queden alcanzar las $10^9$ dimensiones. Las representaciones de distribuciones mediante muestras en altas dimensiones se deteriora debido a la maldición de la dimensionalidad. El EnKF y el VMPF mitigan en parte el problema porque hae un uso más eficiente de las partículas pero por ejemplo la evaluación de pesos en un filtro de partículas como el filtro bootstrap en altas dimensiones se vuelve problemática porque la evaluación de la verosimilitud da valores demasiado próximos a cero. Por estos motivos, la evaluación del EM \textit{online} en espacios de gran dimensionalidad constituye una línea de investigación interesante. En particular, resulta relevante estudiar el desempeño de la metodología en combinación con las estrategias clásicas de asimilación de datos para paliar algunos de estos problemas, tales como la inflación y la localización.

Otras posibles extensiones del EM \textit{online} involucran la combinación de la metodología con filtros de Kalman por ensambles más sofisticados. Por simplicidad nosotros usamos el filtro estocástico \citep{Burgers1998}, sin embargo existe una familia vasta de filtros por ensambles con los que evaluar la técnica. De manera similar, a pesar de que usamos el algoritmo en combinación con un filtro de partículas moderno (el VMPF), la variedad de filtros de partículas es muy amplia y sería valioso estudiar como se desempeña el EM \textit{online} en este espectro de métodos. Por otro lado, la implementación del algoritmo con un paso de suavizado hacia atrás sugiere la posiblidad de una implementación que realiza un suavizado de varios pasos temporales hacia atrás. Esta variación entonces involucra una ventana móvil de manera que el suavizado hacia atrás tiene una interpretación que se denomina \textit{fixed-lagged smoother} \citep{Cosme2012}. Estas ventanas se superpondrían, tal como en una implementación de media móvil pero también existe la posibilidad de considerar ventanas yuxtapuestas en las que se corre el algoritmo EM \textit{batch} clásico, es decir una suerte de implementación con \textit{mini-batchs}. Una adaptación extra que vale la pena considerar es la utilización del EM \textit{online} son distribuciones no Gaussianas. La metodología considera distribuciones de la familia exponencial y en el caso Gaussiano se tiene la ventaja de que la solución que anula al gradiente de la ELBO se puede computar de manera explícita y esto puede no ser el caso para otras distribciones.

La aplicación del EM \textit{online} a modelos epidemiológicos compartimentales, en nuestro conocimiento, no se ha hecho antes. De hecho existen pocos antecedentes de estimación de errores en modelos epidemiológicos

abm: combinación con online EM, modelos de mayor complejidad, observaciones microscópicas
